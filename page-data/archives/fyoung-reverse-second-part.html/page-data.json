{"componentChunkName":"component---src-templates-post-tsx","path":"/archives/fyoung-reverse-second-part.html","result":{"data":{"markdownRemark":{"id":"6da12d86-75af-59ef-843f-2a6ca08f8c77","fields":{"createdAt":1633336580000,"updatedAt":1633336580000,"sourceFileUrl":"https://github.com/ufec/ufec-blog-source/blob/master/content/archives/飞Young逆向分析-第二章.md","slug":"archives/fyoung-reverse-second-part.html","next":{"id":"cbded225-f660-5c84-a8cc-813552e8a597","slug":"archives/fyoung-reverse-first-part.html","thumbnail":"https://my-static.ufec.cn/blog/55d8c8954ec2cbec65d4e25a5da63395.png","title":"飞Young逆向分析-第一章"},"prev":{"id":"6a554975-9a04-5535-8486-0ea3c9dab3b4","slug":"archives/fyoung-reverse-third-part.html","thumbnail":"https://my-static.ufec.cn/blog/5cbc7afdc3fd99feefbb44e3734fcccc.png","title":"飞Young逆向分析-第三章"}},"frontmatter":{"title":"飞Young逆向分析-第二章","author":null,"date":"2021-10-04","updated":"2021-10-04","url":"https://www.ufec.cn/archives/fyoung-reverse-second-part.html","categories":["代码","日常"],"tags":["AndroidStudio","AndroidStudio调试","反编译","逆向"],"thumbnail":"https://my-static.ufec.cn/blog/5cbc7afdc3fd99feefbb44e3734fcccc.png"},"wordCount":{"words":143,"sentences":42,"paragraphs":42},"tableOfContents":"<ul>\n<li><a href=\"#%E9%A3%9E-young-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90-%E7%AC%AC%E4%BA%8C%E7%AB%A0\">飞 Young 逆向分析-第二章</a></li>\n<li><a href=\"#%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90\">代码分析</a></li>\n<li><a href=\"#%E5%8F%82%E6%95%B0%E5%88%86%E6%9E%90\">参数分析</a></li>\n<li><a href=\"#%E5%90%8E%E7%BB%AD\">后续</a></li>\n</ul>","timeToRead":3,"htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{"id":"飞-young-逆向分析-第二章","style":"position:relative;"},"children":[{"type":"text","value":"飞 Young 逆向分析-第二章"},{"type":"element","tagName":"a","properties":{"href":"#%E9%A3%9E-young-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90-%E7%AC%AC%E4%BA%8C%E7%AB%A0","ariaLabel":"飞 young 逆向分析 第二章 permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"继上篇文章 "},{"type":"element","tagName":"a","properties":{"href":"https://www.ufec.cn/archives/fyoung-reverse-first-part.html"},"children":[{"type":"text","value":"飞 Young 逆向分析-第一章"}]},{"type":"text","value":"，我们已经基本了解了密码加密流程和日志的加密流程，但今天分析了其他参数的算法，貌似不是和日志加密算法一样（轻松翻车），但抠出代码调用起来不难。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"代码分析","style":"position:relative;"},"children":[{"type":"text","value":"代码分析"},{"type":"element","tagName":"a","properties":{"href":"#%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90","ariaLabel":"代码分析 permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"其实代码中有我仍然很多迷惑地方，在执行登陆函数的传参处，传入的参数，和代码执行过程中对参数的处理有些看起来有冲突：传入的参数最后一次修改完成后，但后续又有参数 Map 调用了 set 方法，设置了认证请求时的参数，当然这也可能是"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"JD-gui"}]},{"type":"text","value":"、"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"jadx"}]},{"type":"text","value":"对"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"smail"}]},{"type":"text","value":"语法的解释不同，导致经常是一句语句在好几个反编译软件中比较得出结论（我要是会"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"smail"}]},{"type":"text","value":"就好了），主要程序中存在大量"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"if - else"}]},{"type":"text","value":"、循环、"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"try - catch"}]},{"type":"text","value":"，这就导致必须要跟，好多函数光看不能知道条件结果，又得要一边断条调试，一边多个软件中比较代码，很容易出错。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"但我们可以以最好的情况去看，因为代码中有很多条件是对设备的检测，我们大可以以最正常的方式去看代码，就能略过部分繁琐无意义的代码，看了代码也就不难理解"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fyoung"}]},{"type":"text","value":"客户端拨个号能等半天了，迟迟连不上去，十多个参数，走这些流程，算法还得要处理时间。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"参数分析","style":"position:relative;"},"children":[{"type":"text","value":"参数分析"},{"type":"element","tagName":"a","properties":{"href":"#%E5%8F%82%E6%95%B0%E5%88%86%E6%9E%90","ariaLabel":"参数分析 permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"其实在跳转链接（给出登录链接的接口）里返回了一些有用的参数"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr1\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"这个是时间，当然这个参数可以通过格式化时间戳来获取 格式为：yyyyMMddHHmmss"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr2\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"这个参数貌似是用来检测 wifi 的，里面加密了一个 ip 地址，通过 ping 该 ip 地址来检测连接 wifi 是否符合要求"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr15\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"这个参数处理后加密后就是要提交的参数 AidcAuthAttr15"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr16\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"目前没发现这个作用"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr29\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"目前没发现这个作用"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"认证接口所需要的参数，下面这些参数均调用了 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"t.c"}]},{"type":"text","value":" 这个函数，用 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dayKey2"}]},{"type":"text","value":" 对内容加密"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr3\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"对当前应用版本号加密"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr4\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"对当前手机系统信息加密，格式为："},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"android.os.Build.BRAND;android.os.Build.MODEL;android.os.Build.VERSION.RELEASE"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr5\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"其实进行了两次，当我们只关心最后一次，最后一次是对跳转链接中的 IP 加密"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr6\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"也进行了两次，最后一次是对跳转链接中的网卡地址加密"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr7\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"默认为空"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr8\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"这个参数就跟跳转链接中返回的 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"AidcAuthAttr2"}]},{"type":"text","value":" 相关了，从 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"AidcAuthAttr2"}]},{"type":"text","value":" 中解密出 IP 地址，"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"ping"}]},{"type":"text","value":" 操作后会返回成功与否的信息，以及相应时间加密，由于实际操作中我们不可能去做这一步，根据返回信息，我直接伪造了 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"ping"}]},{"type":"text","value":" 操作返回的信息"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr15\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"从跳转链接中取出 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"AidcAuthAttr15"}]},{"type":"text","value":" 该值后，"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"base64"}]},{"type":"text","value":"解码在作为加密函数的第二个参数即可得到该值"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr22\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"用当天 key 对 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"0"}]},{"type":"text","value":" 加密"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AidcAuthAttr23\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"用当天 key 对 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"success"}]},{"type":"text","value":" 加密"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"至此我们已经解决了认证接口中所有的参数，放到 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Postman"}]},{"type":"text","value":" 中请求也是轻松拿下"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://my-static.ufec.cn/blog/27795ce2faedd1778193cf8610fc3678.png","alt":"fyoung_login_success"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"后续","style":"position:relative;"},"children":[{"type":"text","value":"后续"},{"type":"element","tagName":"a","properties":{"href":"#%E5%90%8E%E7%BB%AD","ariaLabel":"后续 permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"接着就是最后一步，还原"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"fyoung"}]},{"type":"text","value":"的自定义加密算法，从而可以直接解出变量值，另外本次用到的逆向工具资源都打包放在了公众号，回复关键字 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"逆向工具"}]},{"type":"text","value":" 即可下载，"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"声明：为了绕过阿里云盘无法分享压缩文件，我将后缀改为了 png，下载后删掉即可"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://my-static.ufec.cn/blog/ed6f784e00f27f9180fc7fba474a06aa.jpg","alt":"qrcode_for_gh_b645da873ba5_258"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"style","properties":{"className":["grvsc-styles"]},"children":[{"type":"text","value":"\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n"}]}],"data":{"quirksMode":false}},"excerpt":"飞 Young 逆向分析-第二章 继上篇文章 飞 Young…"}},"pageContext":{"id":"6da12d86-75af-59ef-843f-2a6ca08f8c77","slug":"archives/fyoung-reverse-second-part.html","next":{"id":"cbded225-f660-5c84-a8cc-813552e8a597","fields":{"slug":"archives/fyoung-reverse-first-part.html"},"frontmatter":{"title":"飞Young逆向分析-第一章"}}}},"staticQueryHashes":["1535296192"]}